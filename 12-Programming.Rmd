# In-Class Programming Activity, Day 12

# Mira

# Testing LDA and QDA

```{r}
library(mosaic)
library(mosaicData)
library(MASS)

```


```{r}
n_cases<-100
red_mean<-c(1,0)
green_mean<-c(0,-1)
blue_mean<-c(-1,1)
covar_red<-cbind(c(3,-1.7),c(-1.7,1))
covar_blue<-cbind(c(2,1.5),c(1.5,3))

One<-cbind(rnorm(n_cases,0,1),rnorm(n_cases,0,1))
Two<-cbind(rnorm(n_cases,0,1),rnorm(n_cases,0,1))
Three<-cbind(rnorm(n_cases,0,1),rnorm(n_cases,0,1))
```

Creating then modifying RGB Matrices
```{r}
Red<-One %*% chol(covar_red)
Green<- Two %*% chol(covar_red) 
Blue<- Three %*% chol(covar_blue)

Red<-cbind(Red,matrix(red_mean,nrow=100))
Green<-cbind(Green,matrix(green_mean,nrow=100))
Blue<-cbind(Blue,matrix(blue_mean,nrow=100))

```

Creating three dataframes
```{r}
Red<-data.frame(Red[,1],Red[,2],class="red")
names(Red)<-c("x","y","class")
Blue<-data.frame(Blue[,1],Blue[,2],class="blue")
names(Blue)<-c("x","y","class")
Green<-data.frame(Green[,1],Green[,2],class="green")
names(Green)<-c("x","y","class")

```

Creating final 2 simulated dataframes
```{r}
Same_sigma<-rbind(Red,Green)
Different_Sigma<-rbind(Red,Blue)
```


LDA and QDA
```{r}
mod_LDA_one <- lda(class~x+y, data = Same_sigma)
test_LDA_one <- predict(mod_LDA_one, newdata = Same_sigma)

```

test_LDA_one: these are the bounds for what the model considers red? as low as the first #, and as high as the 2nd

-0.1477778 -0.09275557   red 

```{r}
table(Same_sigma$class, test_LDA_one$class)

```


```{r}
mod_QDA_one <- qda(class~x+y, data = Same_sigma)
test_QDA_one <- predict(mod_QDA_one, newdata = Same_sigma)
```

       x          y class
       
1 1.32151 -0.6731529   red

qdda and lda are very different....

Confusion Matrices
```{r}
table(Same_sigma$class, test_LDA_one$class)

```

## Test statements

```{r}
scoreActivity::score253(12)
```